apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "dcs-auth.fullname" . }}
  labels:
    app: {{ template "dcs-auth.fullname" . }}
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    release: "{{ .Release.Name }}"
    heritage: "{{ .Release.Service }}"
data:
  service_conf.toml: |-
    title = "DCS Auth Service Configuration. Copyright @DataMesh, 2017."
    LogLevel = {{ .Values.logLevel | default "Info" | quote }}
    ServicePort = ":{{ .Values.servicePort  | default "10400" }}"
    GrpcPort = ":{{ .Values.grpcPort  | default "10401" }}"
    
    [MySQLConfig]
        Tag     = "dcs-auth-mysql"
        Uname   = {{ .Values.mysql.username | quote }}
        Passwd  = {{ .Values.mysql.password | quote }}
        Host    = {{ .Values.mysql.host | quote }}
        Port    = {{ .Values.mysql.port | default "3306" | quote }}
        Dbname  = {{ .Values.mysql.dbname | default "DCS_AUTH_DB" | quote }}
        Charset = "UTF8"
    
    [CacheConfig]
        Address = {{ .Values.cache.address | quote }}
        DbNum = {{ .Values.cache.dbNum | default 11 }}
        IsCluster = {{ .Values.cache.isCluster }}
    
    [CASOptions]
        CASUrl              = {{ .Values.cas.url | quote }}
        SendService         = false
    
    [MessageQueueConf]
        Username = {{ .Values.mq.username }}
        Password = {{ .Values.mq.password }}
        Host     = {{ .Values.mq.host }}
        Port     = {{ .Values.mq.port | default "5672" }}