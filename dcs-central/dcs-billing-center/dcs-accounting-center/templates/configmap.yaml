apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "dcs-accounting-center.fullname" . }}
  labels:
    app: {{ template "dcs-accounting-center.fullname" . }}
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    release: "{{ .Release.Name }}"
    heritage: "{{ .Release.Service }}"
data:
  application.properties: |-
    server.port= {{ .Values.servicePort | default "9003" }}
    grpc.server.port = {{ .Values.GrpcPort | default "50505" }}

    spring.datasource.url = jdbc:mysql://{{ .Values.datasource.host }}:{{ .Values.datasource.port | default "3306" }}/{{ .Values.datasource.dbname | default "dcs_accounting_center_db" }}?{{ .Values.datasource.tinyInt1isBit | default "true" }}&{{ .Values.datasource.autoReconnect | default "true" }}&{{ .Values.datasource.autoReconnectForPools | default "false" }}&{{ .Values.datasource.useUnicode | default "true" }}&{{ .Values.datasource.characterEncoding | default "UTF-8" }}&{{ .Values.datasource.useSSL | default "false" }}
    spring.datasource.username = {{ .Values.datasource.username }}
    spring.datasource.password = {{ .Values.datasource.password }}
    spring.datasource.driver-class-name = com.mysql.jdbc.Driver
    spring.datasource.max-idle = 20
    spring.datasource.max-wait = 60000
    spring.datasource.min-idle = 5
    spring.datasource.initial-size = 5
    spring.datasource.validation-query = SELECT 1
    spring.datasource.test-on-borrow = true
    spring.datasource.test-while-idle = true
    spring.datasource.time-between-eviction-runs-millis = 18800
    spring.datasource.jdbc-interceptors = ConnectionState;SlowQueryReport(threshold=0)
    accounting-center.classified-trial-balance.daily-settlement-hour = 22
    accounting-center.classified-trial-balance.daily-settlement-minute = 0

    #show sql statement
    spring.jpa.database = {{ .Values.sql.dbType }}
    spring.jpa.show-sql = true

